# 任务进度（MVP聚焦版）

## MVP核心任务组（优先级最高）
1. 桌宠主窗口
   - [已完成] 创建无边框、可拖动、置顶窗口
   - [已完成] 支持透明背景
2. Idle动画渲染
   - [已完成] 加载Idle spritesheet
   - [已完成] 实现帧动画循环渲染
3. 资源加载
   - [已完成] 支持本地图片资源的加载与缓存
4. 基础交互
   - [已完成] 支持鼠标拖动桌宠
   - [已完成] 检测桌宠移动至屏幕边界
   - [计划中] 支持简单点击反馈
5. MVP验收
   - [已完成] 桌面出现可拖动、Idle动画循环的小骑士
   - [计划中] 交互与动画流畅不卡顿
   - [计划中] 资源热加载与异常容错

---

## MVP阶段详细任务分解与进度

### 1. 桌宠主窗口模块
- [已完成] 1.1 创建无边框、可拖动、置顶窗口（PyQt/Pygame二选一，优先PyQt）
- [已完成] 1.2 支持透明背景和窗口穿透
- [已完成] 1.3 初始化主窗口与事件循环
- [已完成] 1.4 托盘菜单与退出功能

### 2. Idle动画渲染模块
- [已完成] 2.1 设计Idle动画资源目录结构（sprites/idle/*.png）
- [已完成] 2.2 动画渲染与多状态切换系统MVP实现
    - [已完成] 2.2.1 准备并加载 Idle 序列帧资源 (`assets/images/characters/knight/idle/`)。
    - [已完成] 2.2.2 实现动画播放逻辑 (`animation.py`)。
    - [已完成] 2.2.3 将动画帧绘制到主窗口 (`main_pet_window.py`)。
    - [已完成] 2.2.4 通过状态机触发 Idle 动画播放 (通过简单的播放控制实现)。
    - [已完成] 2.2.5 创建主程序入口 (`main.py`) 以运行动画。
- [计划中] 2.3 动画渲染TDD测试用例设计
- [待完善] 2.4 动画刷新与窗口重绘联动
- [计划中] 2.5 动画资源热更新与缓存机制

### 3. 资源加载与缓存模块
- [已完成] 3.1 资源加载器支持本地图片/音效/文本/json等
- [已完成] 3.2 资源缓存与mock链测试
- [已完成] 3.3 资源加载异常处理与日志

### 4. 基础交互模块
- [已完成] 4.1 鼠标拖动桌宠（窗口随鼠标移动）
- [已完成] 4.2 检测桌宠移动至屏幕边界并自动吸附
- [计划中] 4.3 支持简单点击反馈（如切换表情）
- [计划中] 4.4 交互事件与动画状态联动

### 5. MVP验收目标
- [已完成] 5.1 桌面出现可拖动、Idle动画循环的小骑士
- [计划中] 5.2 交互与动画流畅不卡顿
- [计划中] 5.3 资源热加载与异常容错

---

## 阶段推进策略与依赖说明
- 主窗口与Idle动画为第一优先级，二者互为依赖（窗口先于动画初始化）
- 资源加载为动画与UI的基础依赖，已完成
- 交互与动画状态联动需等主窗口与动画基础完成后推进
- 每一模块推进均需同步单元测试与文档

---

## 进度标记说明
- [计划中]：尚未开发，等待依赖模块或设计完善
- [正实现]：开发中，已进入代码/测试阶段
- [待完善]：已实现基础功能，需补充优化或测试
- [已完成]：功能已完成并通过测试

---

## 后续任务组（按阶段推进）
- 行走/跳跃/攻击动画与状态切换
- 状态机行为管理
- 音效与素材扩展
- 系统监控、工具集、插件等

---

## Sprite Mask Editor深度功能拓展
- [已完成] 帧排序/筛选与命名规则自定义
- [已完成] mask手绘修补与原图细节修补
- [已完成] 帧批量操作、标签备注、批量导入导出
- [已完成] 现代化UI/UX改进及优化
- [已完成] 参数预设、设置保存、动画预览等高级交互

依赖：
- 帧排序/筛选依赖于帧属性结构与UI展示模块
- mask编辑依赖于画布交互与撤销栈
- 批量操作依赖于帧管理与参数序列化
- 动画预览依赖于帧浏览与渲染模块

进展：
- 已完成基础参数体系、输出设置、帧缩略图浏览、自动居中导出等
- 已完成帧排序/筛选与命名规则自定义
- 已完成mask手绘修补（已支持画笔/橡皮、撤销/重做/重置、一键自动修补）
- 已完成帧批量操作（多选、批量标签/备注、批量导入导出）
- 已完成UI/UX现代化改进（选项卡式参数区、滚动缩略图、进度反馈、上下文菜单等）
- 已完成动画预览、参数预设、设置持久化等高级功能

---

# 现有任务可用性标记

- [可直接用] 核心系统相关任务（基础引擎、事件、资源、日志等）
- [可直接用] 渲染系统相关任务（动画、特效、场景等）
- [微调可用] 行为系统相关任务（仅保留Idle动画相关，其他暂缓）
- [后置] 非MVP相关任务（系统监控、工具集、插件、复杂交互等）
- [无用/待定] 与桌宠无关的遗留或实验性任务

---

（如需详细子模块进度，请补充具体实现/负责人）

[2025-04-16 任务进度]
- 已修改: tools/sprite_editor/widgets.py
- 更改: 修复画布指针偏移，统一所有显示模式下的pixmap绘制逻辑，确保与坐标换算一致
- 原因: 保证鼠标操作与实际绘制/擦除位置一致，提升用户体验
- 阻碍因素: 无
- 状态: 成功

[2025-05-11 任务进度]
- 已修改: 
  - assets/sprites/idle/README.md (已删除)
  - assets/sprites/idle/generate_idle_frames.py (已删除)
  - assets/Plan.md (已删除)
  - status/core/asset_manager.py (已删除)
  - status/core/resource_loader.py (已删除)
  - status/core/cache.py (已删除)
  - status/core/scene_manager.py (已删除)
- 更改: 执行第一阶段项目清理，移除旧主题资源和冗余核心模块。
- 原因: 为新主题开发做准备，精简项目结构。
- 阻碍因素: 无法通过工具直接删除二进制文件（如.png）和非空目录，这些需要用户手动处理。
- 状态: 已完成（项目文件结构清理完成，包括根目录、assets、status内部模块、tests目录。status/interaction/interaction_manager.py 中的 CommandManager 引用已移除，但该文件目前仍有较多linter错误。）

[新增任务 2025-05-12]
- 模块: 全局/核心
- 任务: 新主题资源整合与初步UI调整
- 状态: [计划中]
- 描述: 根据新的项目主题（例如猫咪主题），开始整合替换新的视觉、音频等资源。并对现有UI进行初步调整以适应新主题风格。
- 依赖: 项目结构清理完成。
- 优先级: 高 