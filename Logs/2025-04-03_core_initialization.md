# 核心模块初始化日志

**日期**: 2025-04-03
**类别**: 核心, 初始化
**负责人**: Ignorant-lu
**状态**: 已完成

## 概述

本文档记录了Hollow-ming项目核心模块的初始设计和实现。核心模块作为整个系统的基础架构，提供了基本的功能组件和抽象接口，为各个具体功能模块提供支持。

## 实施内容

### 项目基础结构
- 创建了完整的项目目录结构
- 建立了各个模块的基本框架
- 设置了项目文档体系

### 核心模块实现
完成了所有核心模块的设计和实现：
- **app.py**: 应用主类，管理应用生命周期和模块协调
- **event_system.py**: 事件系统，实现模块间事件通知和处理
- **scene_manager.py**: 场景管理器，负责场景的创建、切换和管理
- **resource_loader.py**: 资源加载器，负责加载不同类型的资源文件
- **cache.py**: 缓存系统，管理已加载的资源
- **asset_manager.py**: 资产管理器，整合资源加载和缓存功能

### 场景模块
- **scene_base.py**: 场景基类，定义所有场景的共同接口

## 架构设计

### 设计原则
- **单一职责原则**: 每个模块负责系统中一个单一的功能区域
- **开闭原则**: 设计模块以便扩展，避免修改现有代码
- **依赖倒置原则**: 依赖于抽象而非具体实现
- **接口隔离原则**: 保持接口小而专一
- **组合优于继承**: 使用组合模式构建复杂功能

### 核心模式
- **单例模式**: 应用主类、事件系统、场景管理器和资产管理器均采用单例模式
- **观察者模式**: 事件系统实现了观察者模式，实现系统内的松耦合通信
- **工厂模式**: 场景管理器采用工厂模式创建场景实例
- **策略模式**: 资源加载器使用策略模式处理不同类型的资源

## 技术详情

### 应用主类 (app.py)
- 单例模式实现
- 模块注册和获取机制
- 配置管理系统
- 应用生命周期管理

### 事件系统 (event_system.py)
- 事件类型枚举
- 事件处理器注册和注销
- 事件分发机制
- 异常处理

### 场景管理器 (scene_manager.py)
- 场景类注册
- 场景实例创建和缓存
- 场景切换逻辑
- 场景预加载功能

### 资源加载器 (resource_loader.py)
- 资源类型识别
- 多种资源文件格式支持
- 资源加载错误处理
- 资源目录扫描功能

### 缓存系统 (cache.py)
- 缓存条目生命周期管理
- 最少使用策略清除机制
- 缓存统计和监控
- 自动过期清理

### 资产管理器 (asset_manager.py)
- 资源访问统一接口
- 资源组管理
- 资源预加载机制
- 资源缓存集成

## 接口规范

各模块间的接口已经明确定义，主要依赖关系如下：
- 应用主类依赖于事件系统、场景管理器和资产管理器
- 资产管理器依赖于资源加载器和缓存系统
- 场景管理器依赖于场景基类

## 后续开发计划

1. 实现监控模块，收集系统性能数据
2. 开发渲染系统，提供视觉呈现能力
3. 集成PyQt6，实现图形用户界面
4. 开发系统各个具体场景

## 技术债务
- 资源加载器目前使用占位符实现，等UI库确定后再完善实际实现
- 资产管理器中的资源类型默认生命期需要根据实际使用情况调整
- 需要优化场景管理器的内存使用

## 相关文档
- [设计模式参考](https://refactoring.guru/design-patterns)
- [PyQt6文档](https://www.riverbankcomputing.com/static/Docs/PyQt6/)
- [Python单例模式最佳实践](https://python-patterns.guide/gang-of-four/singleton/) 